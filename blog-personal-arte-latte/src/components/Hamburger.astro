---
import { Menu, X } from "lucide-astro";
---

<button
  id="mobileMenuToggle"
  class="text-[#6F4E37] dark:text-[#E6D5C3] hover:bg-[#E6D5C3]/50 dark:hover:bg-[#483434]/50 rounded-full p-2"
  aria-label="Toggle mobile menu"
>
  <Menu id="menuIcon" class="h-6 w-6" />
  <X id="closeIcon" class="h-6 w-6 hidden" />
</button>

<script>
  const mainToggleMenu = () => {
    const mobileMenuToggle = document.querySelector("#mobileMenuToggle");
    const mobileMenu = document.querySelector("#mobileMenu");
    const menuIcon = document.querySelector("#menuIcon");
    const closeIcon = document.querySelector("#closeIcon");
    let isMenuOpen = false;

    const toggleMenu = () => {
      isMenuOpen = !isMenuOpen;
      if (isMenuOpen) {
        mobileMenu?.classList.remove(
          "opacity-0",
          "-translate-y-4",
          "pointer-events-none",
        );
        mobileMenu?.classList.add("opacity-100", "translate-y-0");
        menuIcon?.classList.add("hidden");
        closeIcon?.classList.remove("hidden");
      } else {
        mobileMenu?.classList.add(
          "opacity-0",
          "-translate-y-4",
          "pointer-events-none",
        );
        mobileMenu?.classList.remove("opacity-100", "translate-y-0");
        menuIcon?.classList.remove("hidden");
        closeIcon?.classList.add("hidden");
      }
    };

    mobileMenuToggle?.addEventListener("click", toggleMenu);
  };

  document.addEventListener("DOMContentLoaded", mainToggleMenu);
  document.addEventListener("astro:after-swap", mainToggleMenu)
</script>
